{% extends "auctions/layout.html" %}

{% block body %}
<div class="container">
    <h2>My Listings</h2>

    {% if listings %}
        {% for listing in listings %}
            <div class="listing-card">
                <h3>
                    <a href="{% url 'listing' listing.id %}">
                        {{ listing.title }}
                        {% if listing.has_updates %}
                            <span class="badge-new">NEW</span>
                        {% endif %}
                    </a>
                </h3>
                
                {% if listing.image_url %}
                    <img src="{{ listing.image_url }}" alt="{{ listing.title }}">
                {% endif %}
                
                <p>{{ listing.description }}</p>
                <p class="price">${{ listing.current_price }}</p>
                
                {% if listing.active %}
                    {% if listing.last_bidder %}
                        <p class="small-text">Last bidder: {{ listing.last_bidder.username }}</p>
                    {% else %}
                        <p class="small-text">No bids yet</p>
                    {% endif %}
                {% endif %}

                {% if listing.active %}
                    <p class="status-active">Active</p>
                {% else %}
                    <p class="status-closed">Closed</p>
                    {% if listing.winner %}
                        <p class="small-text">Winner: {{ listing.winner.username }}</p>
                    {% else %}
                        <p class="small-text">No bids were placed</p>
                    {% endif %}
                {% endif %}
                
                <p class="small-text">Created: {{ listing.created_at|date:"M d, Y" }} | Last updated: {{ listing.last_updated|date:"M d, Y g:i A" }}</p>
            </div>
        {% endfor %}
    {% else %}
        <div class="listing-card">
            <p>You haven't created any listings yet.</p>
            <a href="{% url 'create_listing' %}" class="btn btn-primary">Create Your First Listing</a>
        </div>
    {% endif %}
</div>
{% endblock %}